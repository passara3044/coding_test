<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‡∏°.1</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Sarabun -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
    <!-- Chart.js ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SweetAlert2 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ß‡∏¢‡πÜ -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f9ff; }
        .hidden { display: none; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .emoji-header { font-size: 3rem; margin-bottom: 10px; }
        
        /* Mobile Optimization classes */
        .option-card {
            transition: all 0.2s;
            touch-action: manipulation; /* Improves touch response */
        }
        .option-card:active { transform: scale(0.98); background-color: #eff6ff; }
        .option-card.selected {
            border-color: #3b82f6;
            background-color: #eff6ff;
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.1);
        }
        
        /* Survey Likert Scale Mobile Friendly */
        .likert-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }

        /* Print Styling for Research Report */
        @media print {
            body * { visibility: hidden; }
            #research-report, #research-report * { visibility: visible; }
            #research-report {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0;
                padding: 20px;
                background-color: white;
                border: none;
                font-size: 14pt; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¥‡∏°‡∏û‡πå */
                line-height: 1.5;
            }
            .no-print { display: none !important; }
            /* Reset colors for printing */
            .bg-gray-50 { background-color: white !important; }
            .shadow-xl, .shadow-sm { box-shadow: none !important; }
        }
        
        /* A4 Paper Look for Report Preview */
        .a4-paper {
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: 0 auto;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            font-family: 'Sarabun', sans-serif;
            color: #000;
        }
        .report-section { margin-bottom: 12px; }
        .report-label { font-weight: bold; }
        .dotted-line { border-bottom: 1px dotted #000; display: inline-block; min-width: 50px; }
    </style>
</head>
<body class="text-gray-800 bg-blue-50">

    <!-- Navbar -->
    <nav class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-3 shadow-lg sticky top-0 z-50 no-print">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span class="text-2xl">üíª</span>
                <h1 class="text-lg md:text-xl font-bold truncate">Python & Com-Sci M.1</h1>
            </div>
            <div class="flex gap-2">
                <button onclick="showPage('home')" class="hover:bg-blue-700 px-3 py-1 rounded text-sm md:text-base">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
                <button onclick="checkTeacherAccess()" class="hover:bg-blue-700 px-3 py-1 rounded bg-yellow-500 text-yellow-900 font-bold text-sm md:text-base">üë©‚Äçüè´ ‡∏Ñ‡∏£‡∏π</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto p-4 min-h-screen max-w-4xl">

        <!-- 1. LOGIN PAGE -->
        <div id="page-home" class="page fade-in max-w-lg mx-auto bg-white p-6 md:p-8 rounded-2xl shadow-xl mt-4 md:mt-10 text-center border-t-8 border-blue-500 no-print">
            <div class="emoji-header">üöÄ</div>
            <h2 class="text-2xl md:text-3xl font-bold text-blue-800 mb-2">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡πÇ‡∏•‡∏Å‡πÅ‡∏´‡πà‡∏á‡πÇ‡∏Ñ‡πâ‡∏î!</h2>
            <p class="text-gray-500 mb-6">‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‡∏°.1 (‡∏™‡∏™‡∏ß‡∏ó.)</p>
            
            <form id="loginForm" onsubmit="startQuiz(event)" class="space-y-4 text-left">
                <div>
                    <label class="block text-gray-700 font-bold mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö</label>
                    <select id="examType" class="w-full p-3 border rounded-lg bg-gray-50 focus:ring-2 focus:ring-blue-400 outline-none" required>
                        <option value="Pre-test">üü¢ ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Pre-test)</option>
                        <option value="Post-test">üî¥ ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (Post-test)</option>
                    </select>
                </div>

                <div>
                    <label class="block text-gray-700 font-bold mb-1">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                    <input type="text" id="studentName" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 outline-none" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏î.‡∏ä.‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î" required>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 font-bold mb-1">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                        <select id="studentRoom" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 outline-none" required>
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á</option>
                            <script>
                                for(let i=101; i<=113; i++) {
                                    document.write(`<option value="${i}">‡∏°.1/${i-100} (‡∏´‡πâ‡∏≠‡∏á ${i})</option>`);
                                }
                            </script>
                        </select>
                    </div>
                    <div>
                        <label class="block text-gray-700 font-bold mb-1">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</label>
                        <input type="number" id="studentNo" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-400 outline-none" min="1" max="60" required>
                    </div>
                </div>

                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl shadow-lg transform transition active:scale-95 mt-4">
                    ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö üìù
                </button>
            </form>
        </div>

        <!-- 2. QUIZ PAGE (Adaptive UI) -->
        <div id="page-quiz" class="page hidden max-w-2xl mx-auto no-print">
            <!-- Header Info -->
            <div class="bg-white p-4 rounded-xl shadow-sm mb-4 sticky top-16 z-40 border-l-4 border-indigo-500 flex justify-between items-center">
                <div>
                    <h3 class="font-bold text-gray-700 text-sm md:text-base">‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ö: <span id="display-name" class="text-indigo-600"></span></h3>
                    <div class="text-xs text-gray-400 mt-1">
                        ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà <span id="current-q-display" class="font-bold text-indigo-600 text-lg">1</span> / <span id="total-q-display">20</span>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-xs text-gray-500">‡πÄ‡∏ß‡∏•‡∏≤</div>
                    <div id="timer" class="font-mono text-lg md:text-xl font-bold text-red-500">00:00</div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 rounded-full h-2.5 mb-6">
                <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>

            <!-- Question Card -->
            <div id="question-card" class="bg-white p-6 md:p-8 rounded-2xl shadow-lg min-h-[300px] flex flex-col justify-center fade-in relative">
                <!-- Content injected by JS -->
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between mt-6 gap-4">
                <button onclick="prevQuestion()" id="btn-prev" class="flex-1 bg-gray-200 text-gray-600 font-bold py-3 rounded-xl hover:bg-gray-300 transition hidden">
                    ‚¨ÖÔ∏è ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                </button>
                <button onclick="nextQuestion()" id="btn-next" class="flex-1 bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700 transition shadow-lg">
                    ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°Ô∏è
                </button>
                <button onclick="submitQuiz()" id="btn-submit" class="flex-1 bg-green-500 text-white font-bold py-3 rounded-xl hover:bg-green-600 transition shadow-lg hidden">
                    ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ‚úÖ
                </button>
            </div>
        </div>

        <!-- 3. RESULT PAGE (No Answer Key, Advice Only) -->
        <div id="page-result" class="page hidden max-w-2xl mx-auto text-center fade-in no-print">
            <div class="bg-white p-8 rounded-3xl shadow-2xl mb-8 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-4 bg-gradient-to-r from-green-400 to-blue-500"></div>
                <div class="emoji-header mb-4">üéâ</div>
                <h2 class="text-2xl md:text-3xl font-bold text-gray-800">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!</h2>
                
                <div class="mt-6 mb-8">
                    <p class="text-gray-500">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠</p>
                    <div class="text-6xl font-extrabold text-indigo-600 my-2">
                        <span id="final-score">0</span> <span class="text-2xl text-gray-400">/ 20</span>
                    </div>
                    <p id="score-message" class="text-lg text-gray-600 font-medium">‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å!</p>
                </div>

                <!-- Recommendations Section -->
                <div class="text-left bg-blue-50 p-6 rounded-xl border border-blue-100">
                    <h3 class="font-bold text-lg text-blue-800 mb-3 flex items-center gap-2">
                        üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô)
                    </h3>
                    <div id="recommendation-content" class="space-y-4 text-sm md:text-base text-gray-700">
                        <!-- Content injected by JS -->
                    </div>
                </div>
                
                <!-- Status Box -->
                <div id="sending-status" class="hidden p-4 rounded-lg border mt-4 text-sm"></div>
            </div>

            <!-- Action Buttons -->
            <div id="pretest-actions" class="hidden text-center space-y-4">
                <p class="text-gray-500">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                <button onclick="location.reload()" class="bg-gray-500 text-white px-8 py-3 rounded-full hover:bg-gray-600 transition w-full md:w-auto">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
            </div>

            <!-- Survey Section (Initially Hidden) -->
            <div id="survey-section" class="bg-white p-6 md:p-8 rounded-2xl shadow-xl text-left hidden border-t-4 border-purple-500 mt-6">
                <div class="text-center mb-6">
                    <h2 class="text-xl md:text-2xl font-bold text-purple-700">üìù ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
                    <p class="text-red-500 font-bold mt-2 text-sm md:text-base">** ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô **</p>
                </div>
                <form id="surveyForm" onsubmit="submitSurvey(event)">
                    <div id="survey-questions" class="space-y-8"></div>
                    <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-4 rounded-xl mt-8 shadow-lg text-lg">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô üíæ
                    </button>
                </form>
            </div>
        </div>

        <!-- 4. TEACHER DASHBOARD -->
        <div id="page-teacher" class="page hidden max-w-6xl mx-auto fade-in no-print">
            <div class="bg-white p-6 rounded-2xl shadow-xl mb-6">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                    <h2 class="text-2xl md:text-3xl font-bold text-yellow-600 mb-4 md:mb-0 flex items-center gap-2">üë©‚Äçüè´ ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ñ‡∏£‡∏π</h2>
                    <div class="flex gap-2">
                        <button onclick="generateResearchReport()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm shadow">üìÑ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</button>
                        <button onclick="showPage('home')" class="bg-gray-500 text-white px-4 py-2 rounded text-sm shadow">‡∏≠‡∏≠‡∏Å</button>
                    </div>
                </div>
                
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <label class="font-bold mr-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á:</label>
                    <select id="filter-room" onchange="updateTeacherStats()" class="p-2 border rounded">
                        <option value="all">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                    </select>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-5 gap-3 mb-8 text-center">
                    <div class="bg-blue-100 p-3 rounded-xl"><h4 class="text-blue-800 text-xs md:text-sm font-bold">‡∏ô‡∏£. ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h4><p class="text-2xl md:text-3xl font-bold" id="stat-count">0</p></div>
                    <div class="bg-green-100 p-3 rounded-xl"><h4 class="text-green-800 text-xs md:text-sm font-bold">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Å‡πà‡∏≠‡∏ô</h4><p class="text-2xl md:text-3xl font-bold" id="stat-avg-pre">0.00</p></div>
                    <div class="bg-purple-100 p-3 rounded-xl"><h4 class="text-purple-800 text-xs md:text-sm font-bold">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏´‡∏•‡∏±‡∏á</h4><p class="text-2xl md:text-3xl font-bold" id="stat-avg-post">0.00</p></div>
                    <div class="bg-pink-100 p-3 rounded-xl"><h4 class="text-pink-800 text-xs md:text-sm font-bold">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£</h4><p class="text-2xl md:text-3xl font-bold" id="stat-development">0.00</p></div>
                    <div class="bg-yellow-100 p-3 rounded-xl col-span-2 md:col-span-1">
                        <h4 class="text-yellow-800 text-xs md:text-sm font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h4>
                        <p class="text-2xl md:text-3xl font-bold" id="stat-satisfaction">0.00</p>
                        <p class="text-xs text-yellow-700 mt-1" id="stat-satisfaction-desc">-</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white border rounded-xl p-4 shadow-sm h-64"><canvas id="chart-comparison"></canvas></div>
                    <div class="bg-white border rounded-xl p-4 shadow-sm h-64"><canvas id="chart-distribution"></canvas></div>
                </div>

                <div class="bg-white border rounded-xl p-6 shadow-sm mb-8">
                    <h4 class="font-bold text-lg mb-4 text-indigo-700">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏£‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠</h4>
                    <div id="satisfaction-charts-container" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
                </div>

                <div class="bg-white border rounded-xl p-6 shadow-sm mb-8 overflow-hidden">
                    <h4 class="font-bold text-lg mb-4">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h4>
                    <div class="overflow-x-auto max-h-96">
                        <table class="w-full text-left border-collapse min-w-[600px]">
                            <thead class="sticky top-0 bg-gray-100">
                                <tr class="text-gray-600 uppercase text-xs font-bold">
                                    <th class="py-3 px-4">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                    <th class="py-3 px-4">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
                                    <th class="py-3 px-4">‡∏´‡πâ‡∏≠‡∏á</th>
                                    <th class="py-3 px-4">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                    <th class="py-3 px-4 text-center">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                                    <th class="py-3 px-4 text-center">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</th>
                                </tr>
                            </thead>
                            <tbody id="teacher-scoreboard-body" class="text-gray-600 text-sm">
                                <tr><td colspan="6" class="text-center py-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- RESEARCH REPORT VIEW (ONE PAGE FORMAT) -->
        <div id="research-report" class="hidden a4-paper font-sarabun">
            <div class="text-center mb-4">
                <h2 class="text-xl font-bold">‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÉ‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡πÅ‡∏ö‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)</h2>
            </div>
            
            <div class="space-y-4 text-base">
                <!-- Header Info -->
                <div class="grid grid-cols-1 gap-1">
                    <p><b>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á:</b> ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ú‡∏•‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Python ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                    <div class="flex flex-wrap gap-x-4">
                        <p><b>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ß‡∏¥‡∏à‡∏±‡∏¢:</b> ........................................................................</p>
                        <p><b>‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏π:</b> ....................................</p>
                    </div>
                    <div class="flex flex-wrap gap-x-4">
                        <p><b>‡∏™‡∏≠‡∏ô‡∏ß‡∏¥‡∏ä‡∏≤:</b> ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</p>
                        <p><b>‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤:</b> ‡∏ß21101</p>
                        <p><b>‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà:</b> .......</p>
                        <p><b>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</b> ...............</p>
                    </div>
                </div>

                <!-- Section 1 -->
                <div>
                    <h3 class="font-bold border-b border-black inline-block mb-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h3>
                    <p class="indent-8 text-justify text-sm">‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≤‡∏î‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° ‡∏™‡πà‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏à‡∏∂‡∏á‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏≥‡∏™‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏î‡∏ú‡∏•‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û</p>
                </div>

                <!-- Section 2 -->
                <div>
                    <h3 class="font-bold border-b border-black inline-block mb-1">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h3>
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ú‡∏•‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</li>
                        <li>‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</li>
                    </ul>
                </div>

                <!-- Section 3 -->
                <div>
                    <h3 class="font-bold border-b border-black inline-block mb-1">‡∏ß‡∏¥‡∏ò‡∏µ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h3>
                    <div class="ml-4 text-sm space-y-1">
                        <p><b>‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£/‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:</b> <span id="rep-target">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1.....</span></p>
                        <p><b>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢/‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°:</b> ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á Python</p>
                        <p><b>‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</b> ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô-‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ú‡πà‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</p>
                        <p><b>‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•/‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢:</b> ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (Mean), ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (S.D.), ‡πÅ‡∏•‡∏∞‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞</p>
                    </div>
                </div>

                <!-- Section 4 Results -->
                <div>
                    <h3 class="font-bold border-b border-black inline-block mb-1">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h3>
                    <div class="ml-4 text-sm">
                        <p class="mb-1">‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ö‡∏ß‡πà‡∏≤:</p>
                        <table class="w-full border-collapse border border-black text-center mb-1">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="border border-black p-1">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏Ñ‡∏ô)</th>
                                    <th class="border border-black p-1">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                                    <th class="border border-black p-1">‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                                    <th class="border border-black p-1">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£</th>
                                    <th class="border border-black p-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="border border-black p-1" id="rep-n">-</td>
                                    <td class="border border-black p-1" id="rep-pre-val">-</td>
                                    <td class="border border-black p-1" id="rep-post-val">-</td>
                                    <td class="border border-black p-1 font-bold" id="rep-dev-val">-</td>
                                    <td class="border border-black p-1" id="rep-sat-val">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section 5 Discussion -->
                <div>
                    <h3 class="font-bold border-b border-black inline-block mb-1">‡∏≠‡∏†‡∏¥‡∏õ‡∏£‡∏≤‡∏¢‡∏ú‡∏•</h3>
                    <p class="indent-8 text-justify text-sm">
                        ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ <span id="rep-discuss-dev" class="font-bold">...</span> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ô‡∏ß‡∏±‡∏ï‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö <span id="rep-discuss-sat" class="font-bold">...</span> ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
                    </p>
                </div>

                <!-- Section 6 Suggestions -->
                <div>
                    <h3 class="font-bold border-b border-black inline-block mb-1">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</h3>
                    <p class="indent-8 text-sm">‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≠‡∏¢</p>
                </div>
                
                <!-- Signatures -->
                <div class="flex justify-between mt-8 pt-4">
                     <div class="text-center">
                        <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ .......................................................</p>
                        <p>(.......................................................)</p>
                        <p>‡∏ú‡∏π‡πâ‡∏ß‡∏¥‡∏à‡∏±‡∏¢</p>
                    </div>
                    <div class="text-center">
                        <p>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ .......................................................</p>
                        <p>(.......................................................)</p>
                        <p>‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏™‡∏≤‡∏£‡∏∞‡∏Ø / ‡∏ú‡∏π‡πâ‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Å‡∏≤‡∏£</p>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-6 no-print">
                <button onclick="window.print()" class="bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                <button onclick="document.getElementById('research-report').classList.add('hidden')" class="bg-gray-500 text-white px-4 py-2 rounded shadow ml-2 hover:bg-gray-600">‡∏õ‡∏¥‡∏î</button>
            </div>
        </div>

    </div>

    <script>
        // CONFIG
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxoYQDKg8r4wookMuj-VzeGya_SDGzAlDSO_J_ANJyR1abnUe4XiyY6MZy22HCk2vI6/exec';

        // STATE
        let studentData = {};
        let currentQuestionIndex = 0;
        let userAnswers = new Array(20).fill(null); // Store answers index 0-19
        let timerInterval;
        let seconds = 0;
        let allSheetData = [];
        let satisfactionCharts = [];

        // QUESTIONS
        const questions = [
            // PART 1: PYTHON (0-9)
            { q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏≠‡∏Å‡∏ó‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤ Python?", options: ["input()", "print()", "show()", "output()"], ans: 1 },
            { q: "‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Input) ‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£?", options: ["=", "==", "->", ":"], ans: 0 },
            { q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î‡∏Å‡∏é‡∏Ç‡∏≠‡∏á Python?", options: ["score_1", "myVar", "1number", "_data"], ans: 2 },
            { q: "‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏¢‡∏∏ (Age) ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏î?", options: ["String", "Integer", "Float", "List"], ans: 1 },
            { q: "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á 10 // 3 ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÉ‡∏î?", options: ["3.33", "3", "4", "30"], ans: 1 },
            { q: "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÉ‡∏î‡πÉ‡∏ä‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç '‡∏ñ‡πâ‡∏≤...‡πÅ‡∏•‡πâ‡∏ß'?", options: ["loop", "for", "if", "check"], ans: 2 },
            { q: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÉ‡∏ô Python ‡πÉ‡∏ä‡πâ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡πÉ‡∏î?", options: ["‡∏õ‡∏µ‡∏Å‡∏Å‡∏≤", "‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö", "‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ (Indentation)", ";"], ans: 2 },
            { q: "‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ã‡πâ‡∏≥‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ?", options: ["if-else", "for loop", "while loop", "print"], ans: 1 },
            { q: "‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á turtle.forward(100) ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?", options: ["‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤ 100", "‡∏´‡∏°‡∏∏‡∏ô‡∏Ç‡∏ß‡∏≤ 100", "‡∏ß‡∏≤‡∏î‡∏ß‡∏á‡∏Å‡∏•‡∏°", "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ"], ans: 0 },
            { q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Ñ‡∏∑‡∏≠ Syntax Error?", options: ["‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏¥‡∏î", "‡∏•‡∏∑‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ :", "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡πâ‡∏≤‡∏á", "‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ú‡∏¥‡∏î"], ans: 1 },
            // PART 2: DATA (10-19)
            { q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' ‡πÅ‡∏•‡∏∞ '‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®' ‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á?", options: ["‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®", "‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß", "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏Ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô", "‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"], ans: 1 },
            { q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î **‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà** ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏î‡∏µ?", options: ["‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥", "‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢", "‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏¢‡∏≤‡∏Å", "‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô"], ans: 2 },
            { q: "‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏õ‡∏£‡∏≤‡∏ä‡∏ç‡πå‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≥‡πÇ‡∏Ñ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏î?", options: ["‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏ê‡∏°‡∏†‡∏π‡∏°‡∏¥", "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏ï‡∏¥‡∏¢‡∏†‡∏π‡∏°‡∏¥", "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì", "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå"], ans: 0 },
            { q: "‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Data Processing Cycle) ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÉ‡∏î?", options: ["‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• -> ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• -> ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", "‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -> ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• -> ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•", "‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -> ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• -> ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•", "‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• -> ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -> ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•"], ans: 2 },
            { q: "‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÉ‡∏î‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ '‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏≠‡∏ö'?", options: ["Microsoft Word", "Google Sheets / Excel", "Adobe Photoshop", "Paint"], ans: 1 },
            { q: "‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏î?", options: ["‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå‡∏ó‡∏µ‡∏•‡∏∞‡∏Ñ‡∏ô", "‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°", "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå (Google Forms)", "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°"], ans: 2 },
            { q: "‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏î‡∏ó‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà '‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' (Input) ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå?", options: ["‡∏à‡∏≠‡∏†‡∏≤‡∏û", "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå", "‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î", "‡∏•‡∏≥‡πÇ‡∏û‡∏á"], ans: 2 },
            { q: "‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö '‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ù‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏Å‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' ‡∏Ñ‡∏ß‡∏£‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÉ‡∏î?", options: ["‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢", "‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ó‡πà‡∏á (Bar Chart)", "‡∏†‡∏≤‡∏û‡∏ß‡∏≤‡∏î‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏™‡∏µ", "‡∏ï‡∏≤‡∏£‡∏≤‡∏á"], ans: 1 },
            { q: "‡∏Ç‡πâ‡∏≠‡πÉ‡∏î‡πÄ‡∏õ‡πá‡∏ô '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û'?", options: ["‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å 45 ‡∏Å‡∏Å.", "‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á 160 ‡∏ã‡∏°.", "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ä‡∏≠‡∏ö/‡πÑ‡∏°‡πà‡∏ä‡∏≠‡∏ö", "‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 15,000 ‡∏ö‡∏≤‡∏ó"], ans: 2 },
            { q: "‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à (Data Analytics) ‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?", options: ["‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£", "‡πÄ‡∏™‡∏µ‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô", "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô", "‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå"], ans: 0 }
        ];

        const surveyStructure = [
            { title: "Part 1: ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ Python", items: ["1. ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ Python ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏° (‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å‡∏à‡∏ô‡∏ó‡πâ‡∏≠)", "2. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", "3. ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏à‡∏≠ Error ‡∏û‡∏≠‡πÄ‡∏î‡∏≤‡πÑ‡∏î‡πâ", "4. ‡∏™‡∏ô‡∏∏‡∏Å‡∏ï‡∏≠‡∏ô‡∏Å‡∏î Run ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°", "5. ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à"] },
            { title: "Part 2: ‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠", items: ["6. ‡∏Ñ‡∏£‡∏π‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏á‡πà‡∏≤‡∏¢", "7. ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏ß‡∏•‡∏≤ Code ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô", "8. ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Google Colab ‡πÅ‡∏•‡∏∞ Trinket ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô"] },
            { title: "Part 3: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å", items: ["9. Google Colab ‡πÅ‡∏•‡∏∞ Trinket ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢", "10. ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå/‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏∞‡∏î‡∏ß‡∏Å"] }
        ];
        const surveyQuestionsFlat = [];
        surveyStructure.forEach(p => p.items.forEach(i => surveyQuestionsFlat.push(i)));

        // --- CORE FUNCTIONS ---

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            document.getElementById(`page-${pageId}`).classList.remove('hidden');
            if (pageId === 'teacher') fetchScoreboard();
        }

        function startQuiz(e) {
            e.preventDefault();
            studentData = {
                type: document.getElementById('examType').value,
                name: document.getElementById('studentName').value,
                room: document.getElementById('studentRoom').value,
                no: document.getElementById('studentNo').value
            };
            document.getElementById('display-name').innerText = studentData.name;
            
            // Reset Quiz
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length).fill(null);
            seconds = 0;
            clearInterval(timerInterval);
            
            showPage('quiz');
            renderCurrentQuestion();
            startTimer();
        }

        function renderCurrentQuestion() {
            const q = questions[currentQuestionIndex];
            const card = document.getElementById('question-card');
            const total = questions.length;
            
            // Update Displays
            document.getElementById('current-q-display').innerText = currentQuestionIndex + 1;
            document.getElementById('progress-bar').style.width = `${((currentQuestionIndex + 1) / total) * 100}%`;

            // Render HTML
            let sectionTitle = "";
            if(currentQuestionIndex === 0) sectionTitle = `<span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-bold mb-4">üêç ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° Python</span>`;
            if(currentQuestionIndex === 10) sectionTitle = `<span class="inline-block bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-bold mb-4">üìä ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•</span>`;

            card.innerHTML = `
                ${sectionTitle}
                <h3 class="text-lg md:text-xl font-bold mb-6 text-gray-800 leading-relaxed">${currentQuestionIndex + 1}. ${q.q}</h3>
                <div class="space-y-3">
                    ${q.options.map((opt, i) => `
                        <div onclick="selectAnswer(${i})" 
                             class="option-card border-2 rounded-xl p-4 cursor-pointer flex items-center gap-4 ${userAnswers[currentQuestionIndex] === i ? 'selected border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'}">
                            <div class="w-6 h-6 rounded-full border-2 flex items-center justify-center ${userAnswers[currentQuestionIndex] === i ? 'border-blue-500 bg-blue-500' : 'border-gray-300'}">
                                ${userAnswers[currentQuestionIndex] === i ? '<div class="w-2.5 h-2.5 bg-white rounded-full"></div>' : ''}
                            </div>
                            <span class="text-base md:text-lg text-gray-700">${opt}</span>
                        </div>
                    `).join('')}
                </div>
            `;

            // Button States
            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');
            const btnSubmit = document.getElementById('btn-submit');

            btnPrev.classList.toggle('hidden', currentQuestionIndex === 0);
            
            if (currentQuestionIndex === total - 1) {
                btnNext.classList.add('hidden');
                btnSubmit.classList.remove('hidden');
            } else {
                btnNext.classList.remove('hidden');
                btnSubmit.classList.add('hidden');
            }
        }

        function selectAnswer(optionIndex) {
            userAnswers[currentQuestionIndex] = optionIndex;
            renderCurrentQuestion(); // Re-render to show selection styling
        }

        function nextQuestion() {
            if (userAnswers[currentQuestionIndex] === null) {
                Swal.fire({ toast: true, position: 'center', icon: 'warning', title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ', showConfirmButton: false, timer: 1500 });
                return;
            }
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                renderCurrentQuestion();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderCurrentQuestion();
            }
        }

        function submitQuiz() {
            if (userAnswers[currentQuestionIndex] === null) {
                Swal.fire({ toast: true, position: 'center', icon: 'warning', title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á', showConfirmButton: false, timer: 1500 });
                return;
            }

            // Calculate Score
            let correct = 0;
            let part1Score = 0; // Python (0-9)
            let part2Score = 0; // Data (10-19)

            userAnswers.forEach((ans, idx) => {
                if (ans === questions[idx].ans) {
                    correct++;
                    if(idx < 10) part1Score++; else part2Score++;
                }
            });

            clearInterval(timerInterval);
            document.getElementById('final-score').innerText = correct;
            
            // Generate Message based on score
            let msg = "";
            if (correct >= 16) msg = "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î‡πÑ‡∏õ‡πÄ‡∏•‡∏¢! ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞!";
            else if (correct >= 10) msg = "‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å! ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏™‡∏ö‡∏≤‡∏¢‡πÜ";
            else msg = "‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏ô‡∏¥‡∏î‡∏ô‡∏∞! ‡∏™‡∏π‡πâ‡πÜ";
            document.getElementById('score-message').innerText = msg;

            // Generate Recommendations (No Answer Key)
            generateRecommendations(part1Score, part2Score);

            showPage('result');

            // Handle Post-test/Pre-test logic
            if (studentData.type === 'Pre-test') {
                sendDataToScript(null, null, null, correct); // Send score immediately
                document.getElementById('pretest-actions').classList.remove('hidden');
            } else {
                renderSurvey();
                document.getElementById('survey-section').classList.remove('hidden');
                Swal.fire({ title: '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô', icon: 'success', confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á' });
            }
        }

        function generateRecommendations(p1, p2) {
            const container = document.getElementById('recommendation-content');
            let html = "";

            // Python Logic
            if (p1 < 5) {
                html += `<div class="p-3 bg-red-50 text-red-800 rounded-lg border border-red-200 mb-2">
                            <strong class="block mb-1">‚ùå ‡∏™‡πà‡∏ß‡∏ô Python (‡πÑ‡∏î‡πâ ${p1}/10)</strong>
                            ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á: ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (print, input), ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏©‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Loop
                         </div>`;
            } else {
                html += `<div class="p-3 bg-green-50 text-green-800 rounded-lg border border-green-200 mb-2">
                            <strong class="block mb-1">‚úÖ ‡∏™‡πà‡∏ß‡∏ô Python (‡πÑ‡∏î‡πâ ${p1}/10)</strong>
                            ‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß! ‡∏ù‡∏∂‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡∏à‡∏∞‡πÄ‡∏Å‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏µ‡∏Å‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô
                         </div>`;
            }

            // Data Logic
            if (p2 < 5) {
                html += `<div class="p-3 bg-red-50 text-red-800 rounded-lg border border-red-200">
                            <strong class="block mb-1">‚ùå ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÑ‡∏î‡πâ ${p2}/10)</strong>
                            ‡∏Ñ‡∏ß‡∏£‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•, ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≤‡∏ü
                         </div>`;
            } else {
                html += `<div class="p-3 bg-green-50 text-green-800 rounded-lg border border-green-200">
                            <strong class="block mb-1">‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÑ‡∏î‡πâ ${p2}/10)</strong>
                            ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ
                         </div>`;
            }
            container.innerHTML = html;
        }

        function startTimer() {
            seconds = 0;
            timerInterval = setInterval(() => {
                seconds++;
                const m = Math.floor(seconds / 60).toString().padStart(2, '0');
                const s = (seconds % 60).toString().padStart(2, '0');
                document.getElementById('timer').innerText = `${m}:${s}`;
            }, 1000);
        }

        // --- SURVEY & SUBMISSION ---
        function renderSurvey() {
            const container = document.getElementById('survey-questions');
            container.innerHTML = `<div class="bg-yellow-50 p-4 rounded-lg mb-4 text-sm text-yellow-800">
                <p>‡∏ï‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (5=‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ... 1=‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)</p>
            </div>`;
            
            let qIndex = 0;
            surveyStructure.forEach(part => {
                let html = `<div class="mb-6"><h3 class="font-bold text-indigo-700 mb-3 border-b pb-1">${part.title}</h3>`;
                part.items.forEach(item => {
                    qIndex++;
                    html += `<div class="mb-3 bg-gray-50 p-3 rounded-lg">
                                <p class="text-sm font-medium mb-2">${item}</p>
                                <div class="flex justify-between max-w-xs mx-auto">
                                    ${[1,2,3,4,5].map(v => `
                                        <label class="flex flex-col items-center cursor-pointer">
                                            <input type="radio" name="sq${qIndex}" value="${v}" class="w-5 h-5 accent-purple-600 mb-1" required>
                                            <span class="text-xs text-gray-500">${v}</span>
                                        </label>`).join('')}
                                </div>
                             </div>`;
                });
                container.innerHTML += html + '</div>';
            });
            
            container.innerHTML += `
                <div class="mt-6 border-t pt-4">
                    <h3 class="font-bold text-indigo-700 mb-3">üí¨ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏£‡∏π</h3>
                    <div class="space-y-3">
                        <textarea id="survey-q1" class="w-full border p-2 rounded" placeholder="1. ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏¢‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?" rows="2"></textarea>
                        <textarea id="survey-q2" class="w-full border p-2 rounded" placeholder="2. ‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏à‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?" rows="2"></textarea>
                        <textarea id="survey-q3" class="w-full border p-2 rounded" placeholder="3. ‡∏≠‡∏¢‡∏≤‡∏Å‡∏ö‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏´‡∏°?" rows="2"></textarea>
                    </div>
                </div>`;
        }

        function submitSurvey(e) {
            e.preventDefault();
            let totalRating = 0, count = 10, surveyScores = [], answeredCount = 0;
            
            for(let i=1; i<=10; i++) {
                const els = document.getElementsByName(`sq${i}`);
                let checked = false, val = 0;
                for(let el of els) if(el.checked) { val = parseInt(el.value); checked = true; }
                if(checked) { answeredCount++; surveyScores.push(val); totalRating += val; }
            }

            if(answeredCount < 10) return Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ (10 ‡∏Ç‡πâ‡∏≠)', 'warning');
            
            const avg = (totalRating / count).toFixed(2);
            const comments = `1. ${document.getElementById('survey-q1').value} | 2. ${document.getElementById('survey-q2').value} | 3. ${document.getElementById('survey-q3').value}`;
            
            // Get final score from element
            const finalScore = document.getElementById('final-score').innerText;
            sendDataToScript(surveyScores, avg, comments, finalScore);
            
            document.getElementById('survey-section').classList.add('hidden');
            Swal.fire('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡∏ó‡∏≥‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö', 'success').then(() => location.reload());
        }

        function sendDataToScript(surveyScores, surveyAvg, surveyComment, scoreToSend) {
            const statusDiv = document.getElementById('sending-status');
            statusDiv.classList.remove('hidden');
            statusDiv.innerHTML = '<span class="animate-pulse text-yellow-600">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>';
            statusDiv.className = "p-3 bg-yellow-50 rounded-lg border border-yellow-200 mt-4 text-sm";

            const script = document.createElement('script');
            const params = new URLSearchParams({
                callback: 'handleResponse',
                type: studentData.type,
                name: studentData.name,
                room: studentData.room,
                no: studentData.no,
                score: scoreToSend
            });

            if (surveyScores) {
                surveyScores.forEach((s, i) => params.append(`s${i+1}`, s));
                params.append('surveyAvg', surveyAvg);
                params.append('surveyComment', surveyComment);
            }

            script.src = `${GOOGLE_SCRIPT_URL}?${params.toString()}`;
            document.body.appendChild(script);
        }

        window.handleResponse = function(response) {
            const statusDiv = document.getElementById('sending-status');
            if (response.result === 'success') {
                statusDiv.innerHTML = '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢';
                statusDiv.className = "p-3 bg-green-50 rounded-lg border border-green-200 mt-4 text-green-700 text-sm font-bold";
            } else {
                statusDiv.innerHTML = '‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
                statusDiv.className = "p-3 bg-red-50 rounded-lg border border-red-200 mt-4 text-red-700 text-sm";
            }
        };

        // --- TEACHER FUNCTIONS (Simplified) ---
        function checkTeacherAccess() {
            Swal.fire({ title: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏π', input: 'password', showCancelButton: true }).then((res) => {
                if (res.isConfirmed && res.value === 'passara') {
                    showPage('teacher');
                    setTimeout(initTeacherDashboard, 500);
                } else if(res.isConfirmed) Swal.fire('‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î', '', 'error');
            });
        }
        
        function fetchScoreboard() {
            const script = document.createElement('script');
            script.src = `${GOOGLE_SCRIPT_URL}?action=read&callback=receiveScores`;
            document.body.appendChild(script);
        }

        window.receiveScores = function(data) {
            if(!Array.isArray(data)) return Swal.fire('Error', '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'error');
            allSheetData = data;
            const tbody = document.getElementById('teacher-scoreboard-body');
            tbody.innerHTML = '';
            data.slice().reverse().forEach(row => {
                let dateStr = row.timestamp ? new Date(row.timestamp).toLocaleDateString('th-TH') : '-';
                tbody.innerHTML += `<tr class="border-b"><td class="p-2">${dateStr}</td><td class="p-2">${row.name}</td><td class="p-2">${row.room}</td><td class="p-2 text-center">${row.score}</td><td class="p-2 text-center">${row.surveyAvg || '-'}</td></tr>`;
            });
            updateTeacherStats();
        };

        function initTeacherDashboard() {
            const sel = document.getElementById('filter-room');
            sel.innerHTML = '<option value="all">‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>';
            for(let i=101; i<=113; i++) sel.innerHTML += `<option value="${i}">‡∏°.1/${i-100}</option>`;
            fetchScoreboard();
        }

        function updateTeacherStats() {
            const room = document.getElementById('filter-room').value;
            let data = allSheetData;
            if(room !== 'all') data = data.filter(d => d.room == room);

            // Basic Stats Logic (Same as before)
            const pre = data.filter(d => d.type === 'Pre-test').map(d => Number(d.score));
            const post = data.filter(d => d.type === 'Post-test').map(d => Number(d.score));
            const avgPre = pre.length ? (pre.reduce((a,b)=>a+b,0)/pre.length).toFixed(2) : "0.00";
            const avgPost = post.length ? (post.reduce((a,b)=>a+b,0)/post.length).toFixed(2) : "0.00";
            
            // Satisfaction Logic
            let qStats = Array(10).fill(null).map(()=>({1:0,2:0,3:0,4:0,5:0})), countSat = 0, sumSat = 0;
            data.forEach(d => {
                if(d.surveyAvg && d.s1) {
                    sumSat += parseFloat(d.surveyAvg); countSat++;
                    for(let i=1; i<=10; i++) if(d['s'+i]) qStats[i-1][d['s'+i]]++;
                }
            });
            const avgSat = countSat ? (sumSat/countSat).toFixed(2) : "0.00";
            
            // Calculate Description Logic (Added this block)
            let satDesc = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
            if(countSat > 0) {
                if(avgSat >= 4.50) satDesc = "‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Excellent)";
                else if(avgSat >= 3.50) satDesc = "‡∏°‡∏≤‡∏Å (Good)";
                else if(avgSat >= 2.50) satDesc = "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á (Fair)";
                else if(avgSat >= 1.50) satDesc = "‡∏ô‡πâ‡∏≠‡∏¢ (Poor)";
                else satDesc = "‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Very Poor)";
            }

            // Update UI
            document.getElementById('stat-count').innerText = data.length;
            document.getElementById('stat-avg-pre').innerText = avgPre;
            document.getElementById('stat-avg-post').innerText = avgPost;
            document.getElementById('stat-development').innerText = (avgPost-avgPre).toFixed(2);
            document.getElementById('stat-satisfaction').innerText = avgSat;
            
            // Check if element exists before setting innerText to avoid error
            const satDescElem = document.getElementById('stat-satisfaction-desc');
            if(satDescElem) satDescElem.innerText = satDesc;

            renderCharts(avgPre, avgPost, post);
            renderSatisfactionCharts(qStats, countSat);
        }

        function renderCharts(pre, post, postScores) {
            // Simplified chart rendering reuse existing logic
            const ctx1 = document.getElementById('chart-comparison').getContext('2d');
            if(window.chartComp) window.chartComp.destroy();
            window.chartComp = new Chart(ctx1, { type: 'bar', data: { labels: ['‡∏Å‡πà‡∏≠‡∏ô', '‡∏´‡∏•‡∏±‡∏á'], datasets: [{ label: '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô', data: [pre, post], backgroundColor: ['#93C5FD', '#34D399'] }] } });
            
            const ctx2 = document.getElementById('chart-distribution').getContext('2d');
            let bins = [0,0,0,0]; postScores.forEach(s => bins[s<=5?0:s<=10?1:s<=15?2:3]++);
            if(window.chartDist) window.chartDist.destroy();
            window.chartDist = new Chart(ctx2, { type: 'doughnut', data: { labels: ['<5', '6-10', '11-15', '>16'], datasets: [{ data: bins, backgroundColor: ['#FCA5A5', '#FDE047', '#93C5FD', '#6EE7B7'] }] } });
        }

        function renderSatisfactionCharts(stats, total) {
            const container = document.getElementById('satisfaction-charts-container');
            container.innerHTML = total === 0 ? '<p class="text-center text-gray-400 col-span-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>' : '';
            if(total === 0) return;
            
            // Render only if data exists (Simplified for brevity)
            if(window.satCharts) window.satCharts.forEach(c => c.destroy());
            window.satCharts = [];
            
            stats.forEach((s, i) => {
                const div = document.createElement('div');
                div.className = "bg-white p-2 border rounded";
                div.innerHTML = `<p class="text-xs font-bold truncate">‡∏Ç‡πâ‡∏≠ ${i+1}</p><div class="h-32"><canvas id="sc-${i}"></canvas></div>`;
                container.appendChild(div);
                const ctx = document.getElementById(`sc-${i}`);
                window.satCharts.push(new Chart(ctx, {
                    type: 'bar',
                    data: { labels: [1,2,3,4,5], datasets: [{ label: '‡∏Ñ‡∏ô', data: [s[1],s[2],s[3],s[4],s[5]], backgroundColor: '#818CF8' }] },
                    options: { maintainAspectRatio: false, plugins: { legend: { display: false } } }
                }));
            });
        }

        function generateResearchReport() {
             // Retrieve values
             const count = document.getElementById('stat-count').innerText;
             const pre = document.getElementById('stat-avg-pre').innerText;
             const post = document.getElementById('stat-avg-post').innerText;
             const dev = document.getElementById('stat-development').innerText;
             const sat = document.getElementById('stat-satisfaction').innerText;
             
             // Safely retrieve description
             const satDescElem = document.getElementById('stat-satisfaction-desc');
             const satDesc = satDescElem ? satDescElem.innerText : "-";
             
             const room = document.getElementById('filter-room').value;
             const roomText = room === 'all' ? '‡∏ó‡∏∏‡∏Å‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' : `‡∏°.1/${room-100}`;

             // Inject to report
             document.getElementById('rep-target').innerText = `‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1 (${roomText}) ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${count} ‡∏Ñ‡∏ô`;
             document.getElementById('rep-n').innerText = count;
             document.getElementById('rep-pre-val').innerText = pre;
             document.getElementById('rep-post-val').innerText = post;
             document.getElementById('rep-dev-val').innerText = (dev > 0 ? '+' : '') + dev;
             document.getElementById('rep-sat-val').innerText = sat + " (" + satDesc + ")";
             
             document.getElementById('rep-discuss-dev').innerText = (dev > 0 ? '+' : '') + dev;
             document.getElementById('rep-discuss-sat').innerText = satDesc;

             // Show report
             document.getElementById('research-report').classList.remove('hidden');
        }
    </script>
</body>
</html>